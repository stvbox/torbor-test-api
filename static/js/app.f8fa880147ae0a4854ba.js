webpackJsonp([1],{0:function(t,e){},"67iS":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),s=(n("7t+N"),n("K3J8"),n("woOf")),o=n.n(s),r=[],i={data:function(){return{routes:[],routesLog:r,googleMapsKye:"AIzaSyBu6ShisHv8uABtNotv6BiQAJqcwHYIAc8",failResult:{data:{status:"FAIL"}}}},created:function(){this.addRoute()},methods:{addToLog:function(t){this.routesLog.unshift(t)},addRoute:function(){this.routes.length>9||this.routes.unshift({fr:null,to:null,dist:null})},routing:function(t,e){var n=this;if(!t[0]||!t[1])return e(this.failResult),void this.addToLog({date:n.strDate(),info:"Не задан маршрут"});var a=[];for(var s in t)a.push(t[s].place_id);this.$http.post("/api/routing",{places:a},{emulateJSON:!1}).then(function(t){e(t.body)},function(){e(n.failResult)})},geocoding:function(t,e){var n=this;this.$http.post("/api/geocoding",{address:t},{emulateJSON:!1}).then(function(t){e(t.body)},function(){e(n.failResult)})},strDate:function(){var t=new Date,e=t.getDate(),n=t.getMonth()+1,a=t.getHours(),s=t.getMinutes();return e<10&&(e="0"+e),n<10&&(n="0"+n),a<10&&(a="0"+a),s<10&&(s="0"+s),e+"/"+n+" в "+a+":"+s}}},l=n("VU/8")(i,null,!1,null,null,null).exports,u=n("mvHQ"),c=n.n(u),d={template:"#geo-place-input",mixins:[l],props:["value"],data:function(){return{debug:null,editMode:!1,searchPhrase:"",variants:[],inputTimer:null,loader:!1}},computed:{currentAddress:function(){return this.value&&this.value.formatted_address?this.value.formatted_address:"(пункт не выбран)"},inputStyle:function(){return this.editMode?{}:{color:"transparent","background-color":"transparent"}},adressStyle:function(){return{display:this.editMode?"none":"block"}},placesStyle:function(){return{display:this.editMode?"block":"none"}}},methods:{searchPlace:function(t){var e=this;this.loader=!0,console.log("запрос: "+t),clearTimeout(this.inputTimer),this.inputTimer=setTimeout(function(){var n=e.inputTimer;e.geocoding(t,function(a){n==e.inputTimer&&(e.loader=!1,console.log("ответ: "+t),console.log(c()(a.data.results)),a.data.results?e.variants=a.data.results:e.variants=[])})},1e3)},selectAddress:function(t){this.$emit("input",t),this.searchPhrase=""},onFocus:function(){console.log("onFocus"),this.editMode=!0},onBlur:function(){console.log("onBlur"),this.editMode=!1}}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"geo-input-holder form-control"},[n("div",{staticClass:"input-border"},[n("div",{staticClass:"input-address",style:t.adressStyle},[n("span",[t._v(t._s(t.currentAddress))])]),t._v(" "),n("div",{staticClass:"input-places shadow-sm p-1 mb-5 bg-white rounded",class:{loader:t.loader},style:t.placesStyle},t._l(t.variants,function(e){return n("div",{key:e.place_id,on:{mousedown:function(n){t.selectAddress(e)}}},[t._v("\n                    "+t._s(e.formatted_address)+"\n            ")])})),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchPhrase,expression:"searchPhrase"}],style:t.inputStyle,domProps:{value:t.searchPhrase},on:{focus:function(e){t.onFocus()},blur:function(e){if(e.target!==e.currentTarget)return null;t.onBlur()},keyup:function(e){t.searchPlace(e.target.value)},input:function(e){e.target.composing||(t.searchPhrase=e.target.value)}}})])])},staticRenderFns:[]};var f={template:"#route-counter",mixins:[l],components:{geoplaceinput:n("VU/8")(d,p,!1,function(t){n("67iS")},null,null).exports},data:function(){return{fr:null,to:null,debug:null,busy:!1}},methods:{fieldsToObject:function(t){var e={};for(var n in t)o()(e,t[n]);return e},reset:function(){this.fr=null,this.to=null},calcDistance:function(){if(!this.busy){var t=this;this.busy=!0,this.routing([this.fr,this.to],function(e){for(var n in t.busy=!1,t.debug=e,"FAIL"==e.data.status&&t.addToLog({date:t.strDate(),info:"Сервис не доступен"}),e.data.rows){var a=e.data.rows[n],s=t.fieldsToObject(a.elements);if("ZERO_RESULTS"==s.status&&t.addToLog({date:t.strDate(),info:"Маршрут не найден"}),"OK"==s.status){var o=s.distance.text;t.addToLog({date:t.strDate(),info:e.data.destination_addresses+" > "+e.data.origin_addresses,dist:o})}t.debug=s}})}}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row"},[n("div",{staticClass:"col-md"},[n("geoplaceinput",{model:{value:t.fr,callback:function(e){t.fr=e},expression:"fr"}})],1),t._v(" "),n("div",{staticClass:"col-md"},[n("geoplaceinput",{model:{value:t.to,callback:function(e){t.to=e},expression:"to"}})],1),t._v(" "),n("div",{staticClass:"col-md"},[n("div",{staticClass:"btn-group d-flex justify-content-center bd-highlight",attrs:{role:"group","aria-label":"Кнопки"}},[n("button",{staticClass:"btn btn-primary",class:{loader:t.busy},attrs:{type:"button"},on:{click:function(e){t.calcDistance()}}},[t._v("рассчитать")]),t._v(" "),n("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){t.reset()}}},[t._v("очистить")])])])])},staticRenderFns:[]},h={name:"TorborAgro",components:{routecalc:n("VU/8")(f,v,!1,null,null,null).exports},mixins:[l],data:function(){return{msg:"Welcome to Your Vue.js App"}}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"torbo-app"}},[n("nav",{staticClass:"navbar navbar-expand-lg navbar-dark bg-dark"},[n("a",{staticClass:"navbar-brand",attrs:{href:"#"}},[t._v("Маршрутизатотрон")]),t._v(" "),t._m(0),t._v(" "),n("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarColor01"}},[n("ul",{staticClass:"navbar-nav mr-auto"},[n("li",{staticClass:"nav-item active"},[n("a",{staticClass:"nav-link",attrs:{href:"#"},on:{click:function(e){t.addRoute()}}},[t._v("Еще маршрут "),n("span",{staticClass:"sr-only"},[t._v("(current)")])])])])])]),t._v(" "),t._l(t.routes,function(t){return n("routecalc",{attrs:{data:t}})}),t._v(" "),n("div",[n("table",{staticClass:"table"},[n("tbody",t._l(t.routesLog,function(e){return n("tr",[n("td",[t._v(t._s(e.date))]),t._v(" "),n("td",[t._v(t._s(e.info))]),t._v(" "),n("td",[t._v(t._s(e.dist))])])}))])])],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarColor01","aria-controls":"navbarColor01","aria-expanded":"false","aria-label":"Toggle navigation"}},[e("span",{staticClass:"navbar-toggler-icon"})])}]},b={name:"App",components:{TorborApp:n("VU/8")(h,g,!1,null,null,null).exports}},m={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("TorborApp")],1)},staticRenderFns:[]};var _=n("VU/8")(b,m,!1,function(t){n("UdVn")},null,null).exports,y=n("8+8L");a.a.config.productionTip=!1,a.a.use(y.a),new a.a({el:"#app",components:{App:_},template:"<App/>"})},UdVn:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.f8fa880147ae0a4854ba.js.map